<!DOCTYPE html>
<html>
<head>
    <script src="MainViewSkript.js"></script>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>SQL Insekten</title>

    <link href="stylesheet.css" rel="stylesheet">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
    <!-- highlight js -->
    <link rel="stylesheet" href="highlight/styles/base16/railscasts.min.css">
    <script src="highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

</head>
<body>

    <div class='top'>
        <img id='logo' src="img/OTH_Logo.png"/>
        <h2 id='lvl'>Level: 1</h2>
        <h2 id='hints'>Tipps: 
            <img id='light1' src="img/light.png" /> 
            <img id='light2' src="img/light.png"/>
            <img id='light3' src="img/light.png"/></h2>
        <h2 id='title'>SQL - Insekten</h2>
    </div>

    <div class='leftside'>
    
        <div class='sprechblase'>
            <h2 id='speakbubble_h2'> Willkommen bei SQL-Insekten!</h2>
            <h3>
            <h3 id='speakbubble_h3'> Dies ist ein SQL-Injection-Lernspiel. Mit SQL-Injections (dt. SQL-Einschleußung) kann man Websites hacken,
                 indem man durch das Einschleusen von SQL-Code beliebige Daten in der Datenbank ändern, löschen oder auslesen kann. <br></h3>
            
                <button class="btn btn-lg btn-primary btn-block" id='next_btn' type="submit" onclick="speakbubble_next()">Weiter</button><br>
            <br>
            </h3>
            <br>
        

        </div>

        <div class='animal'> 
            <img id='insect' src="img/bee.png"/>
        </div>

    </div>
    <div class='rightside'>
        <div class='rstop'>

            <div class="wrapper">
                <form class="form-signin">       
                  <h2 id='loginlabel' class="form-signin-heading">Bitte einloggen</h2>
                  <input type="text" class="form-control" name="username" placeholder="Benutzername" id='username' required="" oninput="generate_query(); hljs.highlightAll();" />
                  <input type="password" class="form-control" name="password" placeholder="Passwort" id='password' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); hljs.highlightAll();"/>      
                  <button class="btn btn-lg btn-primary btn-block" id="login_btn" type="button" onclick="try_login()">Einloggen</button>  
                    
                  <input type="text" class="form-control" name="suchleiste" placeholder="" id='suchleiste' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); hljs.highlightAll();"/>  
                  <button class="btn btn-lg btn-primary btn-block" id="suche_btn" type="button" onclick="try_login()">Suchen</button>  
                  <input type="text" value="https://sql-insekten.oth-rgb.de/index.php"class="form-control" name="url" placeholder="" id='url' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); hljs.highlightAll();" /> 
                  <img id='sneaker_img' src="img/sneaker.png"/>
                  <div id='url_output'>
                      <h5 id='marke'>Marke:</h5>
                      <h5 id='groesse'>Größe:</h5>
                      <h5 id= 'price'>Preis:</h5>
                  </div>
                  <table id='suchergebnisse'>

                  </table>
                  <button class="btn btn-lg btn-primary btn-block" id="logout_btn" type="button" onclick="change_form()">Ausloggen</button> 
                </form>
              </div>
        </div>
        <div class='rsbottom'>
            <button class="btn btn-lg btn-primary btn-block" id='behindscene_btn' type="submit" onclick="show_behindscene();hljs.highlightAll();">Hintergrunddetails anzeigen</button> 
            <button class="btn btn-lg btn-primary btn-block" id='tipp_btn' type="submit" onclick="show_hints()">Tipp einblenden</button> 
            <div class='btnbox' id='btnboxre'> 
                <p class='btnboxtxt'>
                </p>
            </div>
            <div class='rsbtmleft'>
            </div>
                <div class='btnbox' id='btnboxli'> 
                    <p class='btnboxtxt'>
                        Hintergrund-Code
                        <label class="switch">
                            <input id='switcher' onclick="change_codemode()" type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                        Erzeugte SQL-Query
                    </p>
                    <pre id="codetxt"><code>
SELECT * 
FROM users 
WHERE username= '' AND password= '';
                    </code></pre>
                    <pre id="behindcodelogin"><code >function validation(){
var uname=document.getElementById("username").value;
var pw=document.getElementById("password").value;
var ergebnis="";
var correctanswer = "";
var querysucessful = "";
// ...
query="SELECT * FROM users WHERE username ='" + uname + "' AND password ='"+ pw + "';";
db.transaction(function(transaction) {
    transaction.executeSql(query,[],function (transaction, results) {
       if (eval(TASKS[task_index].validation[0].truecondition)) {
          querysucessful="true";
          correctanswer= TASKS[0]['validation'][0]['correctanswer'][0]
       } else {
          querysucessful="false";
          correctanswer= TASKS[task_index].validation[0].correctanswer[1];
       }
       ergebnis= results;
    },function(transaction,error){
          correctanswer = TASKS[task_index].validation[0].correctanswer[2];
          querysucessful="error";
                   }
             );
          }
       );
var correct=answer(correctanswer);
form_success(ergebnis,querysucessful,correct);

}</code></pre>
                   <pre id="behindcodesearch"><code ># ...
def validation():
    search=document.getElementById("suchleiste").value
    query="SELECT * FROM shoes WHERE label='" + search + "';"
    ergebnis=""
    correctanswer = ""
    querysucessful = ""
    # ...
    try:
        cursor = connection.cursor()
        cursor.execute(query)
        results = cursor.fetchall()
        if (eval(TASKS[task_index]['validation'][0]['truecondition'])):
            querysucessful="true"
            correctanswer= TASKS[task_index]['validation'][0]['correctanswer'][0]
        else:
            querysucessful="false";
            correctanswer= TASKS[task_index]['validation'][0]['correctanswer'][1]

        ergebnis= results;
        cursor.close()

    except sqlite3.Error as error:
        correctanswer = TASKS[task_index]['validation'][0]['correctanswer'][2]
        querysucessful="error"
    finally:
        if connection:
            connection.close()
            
    correct=answer(correctanswer)
    form_success(ergebnis,querysucessful,correct)

# ...
</code></pre> 
                  <pre id="behindcodeurl"><code >public function validation(){
$url=(string) $doc->getElementById('url')->value;
$id=explode("?", $url );
$query="SELECT * FROM users WHERE ".$id[count(id)-1].";";
$ergebnis="";
$correctanswer = "";
$querysucessful = "";
/* ... */
$db->transaction(function($transaction) {
    $transaction->executeSql($query,[],function ($transaction, $results) {
        if (eval($TASKS[task_index].validation[0].truecondition)) {
            $querysucessful="true";
            $correctanswer= $TASKS[task_index]['validation'][0]['correctanswer'][0];
        } else {
            $querysucessful="false";
            $correctanswer= $TASKS[task_index]['validation'][0]['correctanswer'][1];
        }
        $ergebnis= $results;
    },function($transaction,$error){
        $correctanswer = $TASKS[task_index]['validation'][0]['correctanswer'][2];
        $querysucessful="error";
    }
    );
});
$correct=answer($correctanswer);
form_success($ergebnis,$querysucessful,$correct);
}               
</code></pre> 
                </div>


            
        </div>

        
    </div>
    <div class='bottom'>
        <br>
        <button id='info_btn' onclick="show_info()"><img id='info' src="https://img.icons8.com/ios/50/000000/info--v4.png"/></button> 
        <div id='modal' class='modal'>
            <div class="modal-content">
                <span class="close" onclick="close_modal()">&times;</span>
                <p>            <h3>Informationen</h3>
                    <h5><a href="https://icons8.com/icon/ZiRwjHmdrgtj/info">Info icon by Icons8</a><br>
                    <a target="_blank" href="https://icons8.com/icon/19209/light">Light</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a> <br>
                    <a href='https://de.freepik.com/vektoren/blume'>Blume Vektor erstellt von terdpongvector - de.freepik.com</a><br>
                    <div>Icons made by <a href="https://www.flaticon.com/authors/itim2101" title="itim2101">itim2101</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div></h5>
                    <button class="btn btn-lg btn-primary btn-block" id='btn_modal' type="submit" onclick="close_modal()">Ok</button>
                </p>
              
                </div>
    </div>

    </div>

</body>
</html> 
</html> 