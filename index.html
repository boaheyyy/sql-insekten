<!DOCTYPE html>
<html>
<head>
    <script src="MainViewSkript.js"></script>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>SQL Insekten</title>
    <link rel="icon" href="img/floww.png">
    <link href="stylesheet.css" rel="stylesheet">
    <!-- bootstap template for designing login-section     -->
    <!-- <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="bootstrap.min.css">
    <!-- highlight js -->
    <link rel="stylesheet" href="highlight/styles/base16/railscasts.min.css">
    <script src="highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- /* Attach the Joyride CSS file */ -->
    <link rel=" stylesheet" type="text/css" href="joyride-2.0.0/joyride-2.1.css">

    <!-- /* jQuery needs to be attached */ -->
    <script src="joyride-2.0.0/jquery-1.10.1.js"></script>

    <!-- /* Then attach the Joyride plugin */ -->
    <script src="joyride-2.0.0/jquery.joyride-2.1.js"></script>
    <script type="text/javascript" src="joyride-2.0.0/jquery.cookie.js"></script>
    <script type="text/javascript" src="joyride-2.0.0/modernizr.mq.js"></script> 

</head>
<body>
    <ol id="joyRideTipContent">
      <li data-class="animal" data-text="Weiter" class="custom" data-options="tipLocation:top;" id="first">
        <br>
        <h1> Willkommen bei SQL-Insekten!</h1><br> <br>
            <h3> Dies ist ein SQL-Injection-Lernspiel. Mit SQL-Injections (dt. SQL-Einschleußung) kann man Websites hacken,
                 indem man durch das Einschleusen von SQL-Code beliebige Daten in der Datenbank ändern, löschen oder auslesen kann. </h3> <br> 
      </li>
        <li data-id="insect" data-text="Weiter" class="custom" data-options="tipLocation:top;" id="sec">
          <br>
          <h3>Diese Sicherheitslücke ist oft in Anwendungen zu finden, in denen keine Prepared Statements verwendet werden.Da wir dies aus Lernzwecken nicht verwenden, ist hier fast alles möglich! 
            <br> <br> In SQL-Insekten lernst du von Level zu Level wie Hacker diese Sicherheitslücke ausnutzen, dabei wären Vorkenntisse in SQL empfehlenswert.</h3>
        </li>
        <li data-class="form-signin" data-text="Weiter" class="custom" data-options="tipLocation:left;" >
          <br> <br>
          <h3>In diesem ersten Level haben wir hier ein Login-Formular, wie man es so von anderen Websiten kennt. </h3><br> <br>
        </li>
        <li data-id="behindscene_btn" data-text="Weiter" data-options="tipLocation:top-right;" >
          <br>
          <h3>Unter dem Button 'Hintergrunddetails anzeigen' kannst du dir die live-erzeugte SQL-Query anschauen und den Programmcode der Anwendung.</h3>
          <br>
        </li>
        <li data-id="behindscene_btn" data-text="Weiter" class="joyride-tip-guide2" data-options="tipLocation:top-right;" >
            <br>
            <h3>Unter dem Button 'Hintergrunddetails anzeigen' kannst du dir die live-erzeugte SQL-Query anschauen und den Programmcode der Anwendung.</h3>
            <br>
          </li>
        <li data-id="tipp_btn" data-button="Weiter" class="joyride-tip-guide2" data-options="tipLocation:top;" >
          <br>
          <h3>Einen Tipp kannst du dir hier bei dem Button anzeigen lassen. <br></h3>
        
        </li>
        <li data-id="hints" data-button="Weiter"   class="joyride-tip-guide3" data-options="tipLocation:bottom;" >
          <br>
          <h3>Aber Vorsicht: Dir stehen insgesamt nur 3 Tipps zur Verfügung! <br></h3>
        
        </li>

        <li data-id="insect" data-text="Weiter" class="custom" data-options="tipLocation:top-right;" >
          <br>
          <h3> Allgemein versucht man durch geschickten Input in den Eingabefeldern eine Syntax-korrekte SQL-Query zu erzeugen, die die Aufgabe löst.</h3>
        </li>
        <li data-id="insect" data-text="Weiter" class="custom" data-options="tipLocation:top-right;" id="last">
          <br>
          <h3>Hierbei ist es wichtig bewusst rumzuprobieren oder sich die Hindergrunddetails anzuschauen, um zu wissen, wie die Query aus den Werten der Eingabefelder erzeugt wird, die dann schließlich in der Datenbank ausgeführt wird.
            </h3>
        </li>
        <li data-id="insect" data-text="Weiter" class="custom" data-options="tipLocation:top-right;" id="last">
          <br>
          <h3>Kleiner Hinweis im Voraus: In den ersten Levels wirst du geschickt Apostrophe und SQL-Kommentare '--' verwenden.</h3>
        </li>
      </ol>

      <script>
        $(window).load(function() {
          $('#joyRideTipContent').joyride({
            autoStart : true,
            postStepCallback : function (index, tip) {
            if (index == 2) {
              $(this).joyride('set_li', false, 1);
            }
          },
          modal:true,
          expose: true,
          postRideCallback: function (){
            $('.sprechblase').show();
            $('.animal').css('margin-top',"0%");
            $("#insect").attr("src","img/happybee.png");
          }
          });
        });
      </script>
    <div class='topp'>
        <img id='logo' src="img/OTH_Logo.png"/>
        <button id='btn_info' onclick="show_info()"><img id='info' src="img/menu.png"></button>
        <h2 id='lvl'> Level: 1</h2>
        <h2 id='hints'>Tipps: 
            <img id='light1' src="img/light.png" /> 
            <img id='light2' src="img/light.png"/>
            <img id='light3' src="img/light.png"/></h2>
        <h2 id='title'>SQL - Insekten</h2>
    </div>
    <div class='leftside'>

        <div class='sprechblase'>
            <h2 id='speakbubble_h2'> Genug geredet, los gehts! </h2>
            <h3>
            <h3 id='speakbubble_h3'>  </h3>
            
                
            </h3>
            <button class="btn btn-lg btn-primary btn-block" id='next_btn' type="submit" onclick="speakbubble_next()">Weiter</button>
        

        </div>

        <div class='animal'> 
            <img id='insect' src="img/bee.png"/>
        </div>

    </div>
    <div class='rightside'>
        <div class='rstop'>

            <div class="wrapper">
                <form class="form-signin">       
                    
                  <h2 id='loginlabel' class="form-signin-heading">Bitte einloggen</h2>
                  <input type="text" class="form-control" name="username" placeholder="Benutzername" id='username' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); generate_query(); hljs.highlightAll();" />
                  <input type="password" class="form-control" name="password" placeholder="Passwort" id='password' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); generate_query();hljs.highlightAll();"/>      
                  <button class="btn btn-lg btn-primary btn-block" id="login_btn" type="button" onclick="try_login(); generate_query();hljs.highlightAll();">Einloggen</button>  
                    
                  <input type="text" class="form-control" name="suchleiste" placeholder="" id='suchleiste' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event); generate_query();hljs.highlightAll();"/>  
                  <button class="btn btn-lg btn-primary btn-block" id="suche_btn" type="button" onclick="try_login(); generate_query();hljs.highlightAll();">Suchen</button>  
                  <input type="text" value="https://sql-insekten.oth-rgb.de/index.php?produkt_id=0"class="form-control" name="url" placeholder="" id='url' required="" oninput="generate_query(); hljs.highlightAll();" onKeyPress="onEnter(event);generate_query(); hljs.highlightAll();" /> 
                  <div id='url_output'>
                    <img id='sneaker_img' src="img/sneaker.png"/>
                      <h4 id='marke'><strong>Marke: </strong> Nicke</h4>
                      <h4 id='groesse'><strong>Größe: </strong> 40 </h4>
                      <h4 id= 'price'><strong>Preis: </strong> 80€</h4>
                  </div>
                  <table id='suchergebnisse'></table>
                  <button class="btn btn-lg btn-primary btn-block" id="logout_btn" type="button" onclick="change_form(); generate_query();hljs.highlightAll();">Ausloggen</button> 
                </form>
              </div>
        </div>
        
        <div class='rsbottom'>
            <button class="btn btn-lg btn-primary btn-block" id='behindscene_btn' type="submit" onclick="show_behindscene(); generate_query(); hljs.highlightAll();">Hintergrunddetails anzeigen</button> 
            <button class="btn btn-lg btn-primary btn-block" id='tipp_btn' type="submit" onclick="show_hints()">Tipp einblenden</button> 
            <div class='btnbox' id='btnboxre'> 
                <p class='btnboxtxt'>
                </p>
            </div>
            <div class='rsbtmleft'>
            </div>
                <div class='btnbox' id='btnboxli'> 
                    <p class='btnboxtxt'>
                        Hintergrund-Code
                        <label class="switch">
                            <input id='switcher' onclick="change_codemode()" type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                        Erzeugte SQL-Query
                    </p>
                    <pre id="codetxt"><code>
SELECT benutzername 
FROM benutzer 
WHERE benutzername= '' AND passwort= '';
                    </code></pre>

                    <pre id="behindcodelogin"><code overflow="auto">public static User login(String uname, String pw) throws InternalServerErrorException {
 try {
  conn = DriverManager.getConnection(...);
  Statement stmt = conn.createStatement();
  ResultSet rs = stmt.executeQuery("SELECT benutzername " + 
                 "FROM benutzer " +
                 "WHERE benutzername ='" + uname + "' " +
                 "AND passwort ='"+ md5(pw) + "';");
  if (rs.next()){
    return new User(rs.getString("benutzername"));
  }
  return null;
 }
 catch (SQLException e) {
  throw new InternalServerErrorException();
 }
}
//...</code></pre>
                   <pre id="behindcodesearch"><code >def print_search(user_input):
  try:   
    conn = psycopg2.connect(...)
    cur = conn.cursor()
    cur.execute("SELECT produkt_id, marke, groesse, preis "
                "FROM schuhe "
                "WHERE marke='" + user_input + "';")
    row = cur.fetchone()
    while row is not None:
      print("&lt;tr&gt;")
      for col in row: print("&lt;td&gt;"+str(col)+"&lt;/td&gt;")
      print("&lt;/tr&gt;")
      row = cur.fetchone()
      cur.close()
  except (MySQLdb.Error, MySQLdb.Warning) as e:
    print("Internal Server Error")
# ...
</code></pre> 
                  <pre id="behindcodeurl"><code >$conn = new PDO(...);
$qu = "SELECT marke, groesse, preis ";
$qu .= "FROM schuhe ";
$qu .= "WHERE produkt_id=".$_GET["produkt_id"];
$stmt = $conn->query($qu);
$res = $stmt->fetch();

echo &lt;&lt;&lt;OUTPUT
&lt;b&gt;Marke:&lt;/b&gt; {$res["marke"]}&lt;br&gt;
&lt;b&gt;Größe:&lt;/b&gt; {$res["groesse"]}&lt;br&gt;
&lt;b&gt;Preis:&lt;/b&gt; {$res["preis"]}€
OUTPUT;
</code></pre> 
                </div>
       
        </div>

        
    </div>
    <div class='bottomg'>
        <br>
        <div id='modal' class='modal'>
            <div class="modal-content">
                <span class="close" onclick="close_modal()">&times;</span>
                <p>            <h3>Informationen</h3>
                    <h5><a target="_blank" href="https://icons8.com/icon/19209/light">Light</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a> <br>
                    <a href='https://de.freepik.com/vektoren/blume'>Blume Vektor erstellt von terdpongvector - de.freepik.com</a><br>
                    <div>Icons made by <a href="https://www.flaticon.com/authors/itim2101" title="itim2101">itim2101</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div>
                    <div>Icons erstellt von <a href="https://www.freepik.com" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/de/" title="Flaticon">www.flaticon.com</a></div></h5>
                    <button class="btn btn-lg btn-primary btn-block" id='btn_modal' type="submit" onclick="close_modal()">Ok</button>
                </p>
              
                </div>
    </div>

    </div>

</body>
</html> 
</html> 
